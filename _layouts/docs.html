---
layout: default # Or whatever your main site layout is
---

<div class="sf-container">
  <div class="docs-layout-grid">
    
    <!-- Left Column: Sidebar Navigation -->
    <aside class="docs-sidebar">
        <nav class="docs-nav">
            {% assign docs_by_category = site.docs | group_by: "category" %}
            {% for category in docs_by_category %}
              <h2 class="docs-nav__category-title">{{ category.name }}</h2>
              <ul class="docs-nav__list">
                {% assign items = category.items | sort: "order" %}
                {% for doc in items %}
                  <li>
                    <a href="{{ doc.url | relative_url }}" class="docs-nav__link {% if page.url == doc.url %}is-active{% endif %}">
                      {{ doc.title }}
                    </a>
                  </li>
                {% endfor %}
              </ul>
            {% endfor %}
          </nav>
    </aside>
    
    <!-- Center Column: Main Content -->
    <main class="docs-main">
      <header class="docs-header">
        <h1 class="sf-h1">{{ page.title }}</h1>
        {% if page.description %}
          <p class="sf-text--large sf-text--muted">{{ page.description }}</p>
        {% endif %}
      </header>

      <div class="docs-content">
        {{ content }}
      </div>

      <nav class="docs-pagination" aria-label="Documentation Pagination">
        {% if page.previous.url %}
          <a href="{{ page.previous.url | relative_url }}" class="docs-pagination__link docs-pagination__link--prev">
            <i class="ph-bold ph-arrow-left"></i>
            <span class="docs-pagination__label">Previous</span>
            <span class="docs-pagination__title">{{ page.previous.title }}</span>
          </a>
        {% endif %}
      
        {% if page.next.url %}
          <a href="{{ page.next.url | relative_url }}" class="docs-pagination__link docs-pagination__link--next">
            <i class="ph-bold ph-arrow-right"></i>
            <span class="docs-pagination__label">Next</span>
            <span class="docs-pagination__title">{{ page.next.title }}</span>
          </a>
        {% endif %}
      </nav>
    </main>

    <!-- Right Column: Table of Contents & Ads -->
    <div class="docs-toc-wrapper">
      <aside class="docs-toc">
        <h3 class="docs-toc__title">On this page</h3>
        <ul id="docs-toc-list" class="docs-toc__list">
          <!-- TOC items will be generated by JavaScript -->
        </ul>
      </aside>
      <div class="docs-ad">
        <i class="ph-bold ph-storefront"></i>
        <span>Advertisement</span>
      </div>
    </div>

  </div>
</div>

<script>
// assets/js/docs.js

document.addEventListener('DOMContentLoaded', () => {
  const contentArea = document.querySelector('.docs-content');
  const tocList = document.getElementById('docs-toc-list');
  const headings = contentArea.querySelectorAll('h2, h3');
  
  if (!tocList || headings.length === 0) {
    // No TOC container or no headings on the page, do nothing.
    return;
  }

  // 1. Generate Table of Contents
  headings.forEach(heading => {
    const id = heading.id || heading.textContent.toLowerCase().replace(/\s+/g, '-').replace(/[^\w-]+/g, '');
    heading.id = id;

    const listItem = document.createElement('li');
    listItem.className = `docs-toc__item docs-toc__item--${heading.tagName.toLowerCase()}`;
    
    const link = document.createElement('a');
    link.className = 'docs-toc__link';
    link.href = `#${id}`;
    link.textContent = heading.textContent;
    link.dataset.targetId = id;

    listItem.appendChild(link);
    tocList.appendChild(listItem);
  });

  // 2. Implement Scroll-Spying for active TOC link
  const tocLinks = tocList.querySelectorAll('.docs-toc__link');
  
  const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      const id = entry.target.getAttribute('id');
      const tocLink = tocList.querySelector(`a[data-target-id="${id}"]`);
      
      if (entry.isIntersecting && entry.intersectionRatio > 0) {
        // Deactivate all links first
        tocLinks.forEach(link => link.classList.remove('is-active'));
        // Activate the current one
        tocLink.classList.add('is-active');
      }
    });
  }, { 
    // Trigger when the heading is at the top quarter of the viewport
    rootMargin: '-25% 0px -75% 0px',
    threshold: 0 
  });

  headings.forEach(heading => observer.observe(heading));
});
</script>