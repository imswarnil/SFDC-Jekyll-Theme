<!-- ============================================================================
_includes/navbar.html (Premium Animation Edition - MODIFIED FOR MULTI-THEME)
============================================================================ -->

<header class="sf-header">
<div class="sf-container sf-header__bar">

<a href="{{ '/' | relative_url }}" class="sf-brand">
 <svg width="100px" height="100px" class="sf-brand__image-logo" viewBox="-4.8 -4.8 57.60 57.60" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      /* Original #0176d3 (blue hair/hat) -> Mapped to --sf-brand */
      .cls-1 {
        fill: var(--sf-brand, #0176d3); 
      }

      /* Original #f7cc94 (main skin tone) -> Mapped to --sf-bg-2 (primary surface color) */
      .cls-2 {
        fill: var(--sf-bg-2, #f7cc94);
      }
      
      /* Original #f4b392 (shadow skin tone) -> Mapped to --sf-line-2 (subtle line/bg color) */
      .cls-3 {
        fill: var(--sf-line-2, #f4b392);
      }
      
      /* Original #03243f (dark outlines) -> Mapped to --sf-fg (main foreground/text color) */
      .cls-4 {
        fill: var(--sf-fg, #03243f);
      }
      
      /* Original #03243f (stroked paths) -> Also mapped to --sf-fg */
      .cls-5 {
        fill: none;
        stroke: var(--sf-fg, #03243f);
        stroke-linecap: round;
        stroke-linejoin: round;
        stroke-width: 0.24;
      }
    </style>
  </defs>
  <g id="hair">
    <!-- Each path below will now use the dynamic classes defined in the <style> block -->
    <path class="cls-1" d="M44.11,44.5H3.89C3.89,37.56,7,31.93,14,31.93h20.1c6.94,0,10.06,5.63,10.06,12.57Z"></path>
    <path class="cls-2" d="M27.77,21.88V33.19a3.77,3.77,0,1,1-7.54,0V21.88Z"></path>
    <path class="cls-3" d="M31.46,18.11a10.4,10.4,0,0,1-3.69,7.44v2.51a5.91,5.91,0,0,1-7.54,0V25.55a10.4,10.4,0,0,1-3.69-7.44c.45-4.95,3.61-8.8,7.46-8.8S31,13.16,31.46,18.11Z"></path>
    <path class="cls-2" d="M31.54,16.85a10.26,10.26,0,0,1-.08,1.26,10.4,10.4,0,0,1-3.69,7.44,5.91,5.91,0,0,1-7.54,0,10.4,10.4,0,0,1-3.69-7.44,10.26,10.26,0,0,1-.08-1.26c0-5.55,3.37-10,7.54-10S31.54,11.3,31.54,16.85Z"></path>
    <path class="cls-2" d="M34.05,16.85a2.51,2.51,0,0,1-2.51,2.52c-1.39,0,0-1.13,0-2.52s-1.39-2.51,0-2.51A2.51,2.51,0,0,1,34.05,16.85Z"></path>
    <path class="cls-2" d="M14,16.85a2.51,2.51,0,0,0,2.51,2.52c1.39,0,0-1.13,0-2.52s1.39-2.51,0-2.51A2.51,2.51,0,0,0,14,16.85Z"></path>
    <circle class="cls-4" cx="20.98" cy="14.59" r="0.5"></circle>
    <circle class="cls-4" cx="27.02" cy="14.59" r="0.5"></circle>
    <path class="cls-5" d="M19.22,13.08s1.71-2,3.52-1"></path>
    <path class="cls-5" d="M28.78,13.08s-1.71-2-3.52-1"></path>
    <path class="cls-5" d="M23.5,15.09s-2,5-1,5h1"></path>
    <path class="cls-5" d="M23.5,22.13s3,0,4-1"></path>
    <path class="cls-4" d="M21.49,11.07C25,13.59,28,14.59,30,14.59S36.16,11.08,34.79,7c-.5-1.51-1-2.94-5.76-3.44-3.54-.37-9.55,2.52-9.55,2.52A6.61,6.61,0,0,0,17,5.54c-5,0-2,8-.52,9.53C16.94,15.57,18.9,9.22,21.49,11.07Z"></path>
  </g>
</svg>
 <div class="sf-brand__text">
   <div class="sf-h5 sf-mb-0 sf-brand-title">{{ site.title }}</div>
   <div style="font-size: xx-small;" class="sf-text--small">{{ site.job_title }}</div>
 </div>
</a>

<nav class="sf-nav--desktop" aria-label="Main navigation">
 {% for item in site.navigation_header %}
   <a href="{{ item.url | relative_url }}" class="sf-nav--desktop__link {% if page.url == item.url %}is-active{% endif %}">
     {% if item.icon %}<i class="ph-bold ph-{{ item.icon }}"></i>{% endif %}
     <span>{{ item.title }}</span>
   </a>
 {% endfor %}
</nav>

<div class="sf-header__actions">
 <button class="sf-header__action-btn" aria-label="Open Search" data-toggle="search-panel">
   <i class="ph-bold ph-magnifying-glass"></i>
 </button>
 <a href="https://github.com/your-username" class="sf-header__action-btn" aria-label="GitHub Profile" target="_blank" rel="noopener noreferrer">
   <i class="ph-bold ph-github-logo"></i>
 </a>
 
 <!-- THEME SWITCHER (MODIFIED) -->
 <button class="sf-header__action-btn sf-theme-switcher" aria-label="Toggle theme">
   <i class="ph-bold ph-sun"></i>        <!-- For switching back to Light -->
   <i class="ph-bold ph-cloud"></i>       <!-- For switching to Dark -->
   <i class="ph-bold ph-sun-horizon"></i> <!-- For switching to Sunset -->
   <i class="ph-bold ph-leaf"></i>        <!-- For switching to Nature -->
   <i class="ph-bold ph-palette"></i>     <!-- For switching to B&W -->
 </button>
 
 <button class="sf-nav-toggle" aria-label="Toggle navigation" data-toggle="nav-panel">
   <span></span><span></span><span></span>
 </button>
</div>
</div>
</header>

<!-- Search Panel (Modal) -->
<div class="sf-search-panel" id="search-panel">
<div class="sf-container">
<div class="sf-search-panel__form">
 <i class="ph-bold ph-magnifying-glass" style="font-size: 1.5rem; color: var(--sf-muted);"></i>
 <input type="search" id="sf-search-input" class="sf-search-panel__input" placeholder="Search..." autocomplete="off" />
 <button type="button" class="sf-header__action-btn" aria-label="Close Search" data-toggle="search-panel">
   <i class="ph-bold ph-x"></i>
 </button>
</div>
</div>
</div>

<!-- Search Results Container -->
<div class="sf-search-results-wrapper" id="sf-search-results-wrapper">
<ul class="sf-search-results" id="sf-search-results-list"></ul>
</div>

<!-- Mobile Navigation Panel (Modal) -->
<div class="sf-nav-panel" id="nav-panel">
<div class="sf-nav-panel__backdrop" data-toggle="nav-panel"></div>
<div class="sf-nav-panel__content">
<header class="sf-nav-panel__header">
 <span>Navigation</span>
 <button class="sf-header__action-btn" aria-label="Close navigation" data-toggle="nav-panel">
   <i class="ph-bold ph-x"></i>
 </button>
</header>
<nav>
 <ul class="sf-nav-panel__list">
   {% for item in site.navigation_header %}
     <li>
       <a href="{{ item.url | relative_url }}" class="sf-nav-panel__link {% if page.url == item.url %}is-active{% endif %}" data-toggle="nav-panel">
         {% if item.icon %}<i class="ph-bold ph-{{ item.icon }}"></i>{% endif %}
         <span>{{ item.title }}</span>
       </a>
     </li>
   {% endfor %}
 </ul>
</nav>
</div>
</div>

<!-- Self-contained JavaScript (MODIFIED) -->
<script>
document.addEventListener('DOMContentLoaded', () => {
const htmlEl = document.documentElement;
const navPanel = document.getElementById('nav-panel');
const searchPanel = document.getElementById('search-panel');
const searchResultsWrapper = document.getElementById('sf-search-results-wrapper');

// --- Panel Toggling ---
document.querySelectorAll('[data-toggle]').forEach(toggle => {
 toggle.addEventListener('click', (event) => {
   const targetPanel = document.getElementById(toggle.getAttribute('data-toggle'));
   if (!targetPanel) return;
   const isOpen = targetPanel.classList.toggle('is-open');

   if (targetPanel.id === 'nav-panel') {
     htmlEl.style.overflow = isOpen ? 'hidden' : '';
     document.querySelector('.sf-nav-toggle').classList.toggle('is-active', isOpen);
   }
   if (targetPanel.id === 'search-panel') {
       searchResultsWrapper.classList.toggle('is-active', isOpen);
       if (isOpen) setTimeout(() => targetPanel.querySelector('input[type="search"]').focus(), 500);
   }
 });
});

// --- THEME SWITCHING (MODIFIED FOR 5 THEMES) ---
const themeSwitcher = document.querySelector('.sf-theme-switcher');
const themes = ['light', 'dark', 'sunset', 'nature', 'b&w'];

const setTheme = theme => {
 document.body.classList.add('theme-transitioning');
 htmlEl.setAttribute('data-theme', theme);
 localStorage.setItem('theme', theme);
 setTimeout(() => document.body.classList.remove('theme-transitioning'), 500);
};

const savedTheme = localStorage.getItem('theme');
const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
const initialTheme = savedTheme || (prefersDark ? 'dark' : 'light');
setTheme(initialTheme);

themeSwitcher.addEventListener('click', () => {
  const currentTheme = htmlEl.getAttribute('data-theme') || 'light';
  const currentIndex = themes.indexOf(currentTheme);
  const nextIndex = (currentIndex + 1) % themes.length;
  const nextTheme = themes[nextIndex];
  setTheme(nextTheme);
});

// --- Live Search ---
const searchInput = document.getElementById('sf-search-input');
const resultsList = document.getElementById('sf-search-results-list');
let pages = [];
fetch('{{ "/assets/search.json" | relative_url }}').then(res => res.json()).then(data => pages.push(...data));
searchInput.addEventListener('keyup', function() {
 const term = this.value.trim();
 if (!term) { resultsList.innerHTML = ''; return; }
 const results = pages.filter(p => new RegExp(term, 'gi').test(p.title) || new RegExp(term, 'gi').test(p.content));
 if (results.length > 0) {
   resultsList.innerHTML = results.map(item => `
     <li class="sf-search-result">
       <a href="${item.url}" class="sf-search-result__link">
         <h4 class="sf-search-result__title">${item.title}</h4>
         <p class="sf-search-result__excerpt">${item.excerpt}</p>
       </a>
     </li>`).join('');
 } else {
   resultsList.innerHTML = `<div class="sf-search-panel__no-results">No results found for "${term}"</div>`;
 }
});

// --- Clear search on close ---
document.querySelectorAll('[data-toggle="search-panel"]').forEach(btn => {
 btn.addEventListener('click', () => {
   if (searchPanel && searchPanel.classList.contains('is-open')) {
       setTimeout(() => { searchInput.value = ''; resultsList.innerHTML = ''; }, 500);
   }
 });
});
});
</script>