/* ============================================================================
   PAGE / 404 FILM "Astro's Lost Transmission" (Restored)
   An interactive, animated 404 page featuring official Salesforce characters.
   ============================================================================ */

// --- Keyframe Library ---
@keyframes stars-twinkle {
  from { transform: scale(1); opacity: 0.5; }
  to { transform: scale(1.1); opacity: 1; }
}

@keyframes static-noise {
  0% { transform: translate(0,0); }
  10% { transform: translate(-5%,-10%); } 20% { transform: translate(-15%,5%); }
  30% { transform: translate(7%,-15%); }  40% { transform: translate(-5%,15%); }
  50% { transform: translate(-15%,-5%); } 60% { transform: translate(15%,0); }
  70% { transform: translate(0,10%); }    80% { transform: translate(-15%,-10%); }
  90% { transform: translate(10%,5%); }   100% { transform: translate(0,0); }
}

@keyframes static-screen-in {
  from { clip-path: inset(50% 50% 50% 50%); }
  to { clip-path: inset(0% 0% 0% 0%); }
}

@keyframes character-float {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-15px); }
}

@keyframes content-reveal {
  from { opacity: 0; }
  to { opacity: 1; }
}

// --- Main Stage ---
.page-404-film {
  display: grid;
  place-items: center;
  min-height: 80vh;
  padding: var(--sf-4);
  background-color: #0c1427; // Deep space color
  overflow: hidden;
}

.film-stage {
  position: relative;
  width: min(800px, 90vw);
  aspect-ratio: 16 / 9;
  border-radius: var(--sf-radius-xl);
  overflow: hidden;
  box-shadow: var(--sf-shadow-lg);
  background-color: #0c1427;
  cursor: pointer; // Indicate that it's interactive

  // Each .film-scene is a layer in our animation
  .film-scene {
    position: absolute;
    inset: 0;
  }
}

// --- Layer 1: Space ---
.film-scene--space {
  .space__stars {
    position: absolute;
    inset: 0;
    background-image:
      radial-gradient(1px 1px at 25% 25%, white, transparent),
      radial-gradient(1px 1px at 75% 75%, white, transparent),
      radial-gradient(2px 2px at 50% 90%, white, transparent);
    background-size: 200px 200px;
    animation: stars-twinkle 4s ease-in-out infinite alternate;
    &:nth-child(2) { background-size: 300px 300px; animation-delay: -2s; }
    &:nth-child(3) { background-size: 100px 100px; animation-delay: -4s; }
  }
  .space__404-ghost {
    @include center;
    width: 100%;
    height: 100%;
    font-size: clamp(8rem, 30vw, 20rem);
    font-family: var(--sf-font-mono);
    font-weight: 900;
    color: white;
    opacity: 0.05;
    transition: opacity .5s ease;
  }
}

// --- Layer 2: Static ---
.film-scene--static {
  opacity: 0; // Hidden by default
  .static__overlay {
    width: 100%;
    height: 100%;
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAAUVBMVEWFhYWDg4N3d3dtbW17e3t1dXWBgYGHh4d5eXlzc3OLi4ubm5uVlZWPj4+NjY19fX2JiYl/f39ra2uRkZGZmZlpaWmXl5dvb29xcXGTk5NnZ2c8TV1mAAAAG3RSTlNAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEAvEOwtAAAAFVLSURBVDjL7c5HAnAABADeoZv//+RCQjPAkwAiJEAJqZbOZxTTzhdbuExiCRNaxkYWcyuALEWKQtFYupC2FUyJhDF31relZMao5sCrHoE7A1SjYfmzWy4fG5wwXqrNZ5p2mrBDp9Z8kGHrEa8h09Z8rBH3aKbD5kxpP230YV2llBcZz0i13Lpi7g7YjYjLDjCIyIMPoGHBH5BAaMAA7');
    animation: static-noise 0.1s steps(2) infinite;
  }
}

// --- Layer 3: Characters ---
.film-scene--characters {
  opacity: 0; // Hidden by default
  @include center($justify: center, $align: flex-end);
  padding-bottom: 5%;

  .character {
    width: clamp(80px, 15vw, 150px);
    animation: character-float 6s ease-in-out infinite;
    img { filter: drop-shadow(0 15px 20px rgba(0,0,0,0.3)); }
    &--astro { animation-delay: -3s; }
    &--codey { transform: scaleX(-1); } // Make Codey face Astro
  }
}

// --- Layer 4: Content ---
.film-scene--content {
  @include center;
  flex-direction: column;
  text-align: center;
  color: var(--sf-fg);
  padding: var(--sf-4);
  background: linear-gradient(to top, var(--sf-bg-1) 20%, transparent 100%);

  .content-wrapper {
    opacity: 0; // Content text is hidden by default
  }
  .content__title { font-size: var(--sf-text-2xl); font-weight: 700; }
  .content__subtitle { color: var(--sf-muted); max-width: 45ch; margin: var(--sf-3) auto var(--sf-5); }
  
  // Self-contained button styles for the 404 page
  .sf-btn {
    @include control-base();
    @include cluster($gap: var(--sf-2), $align: center);
    font-weight: 600;
    padding-inline: var(--sf-4);
    text-decoration: none;
    transition: all .2s ease;
    box-shadow: var(--sf-shadow-sm);

    &--primary {
      background-color: var(--sf-brand);
      color: white;
      border-color: var(--sf-brand);
      @include hover { background-color: var(--sf-brand-hover); }
    }
    @include hover {
      transform: translateY(-2px);
      box-shadow: var(--sf-shadow-md);
    }
  }
}

// --- THE INTERACTIVE ANIMATION DIRECTOR ---
// The `.is-playing` class will be added by JavaScript on hover/tap
.film-stage.is-playing {
  // Hide the ghost 404
  .space__404-ghost { opacity: 0; }

  // Animate in the static screen
  .film-scene--static {
    opacity: 1;
    animation: static-screen-in 0.3s cubic-bezier(0.77, 0, 0.175, 1) forwards;
    animation-delay: 0s;
  }

  // Fade out the static and fade in the characters after 3s
  .film-scene--static {
    animation-name: static-screen-in, content-reveal; // Chain animations
    animation-direction: normal, reverse;
    animation-duration: 0.3s, 0.5s;
    animation-delay: 0s, 3s; // Animate out at 3s
  }
  .film-scene--characters {
    opacity: 1;
    animation: content-reveal 1s ease forwards;
    animation-delay: 3s; // Animate in at 3s
  }
  
  // Fade in the text content at the end
  .content-wrapper {
    animation: content-reveal 1s ease forwards;
    animation-delay: 3.5s;
  }
}