/* ============================================================================
   ABSTRACTS / ROOT (SCSS-FIRST VERSION)
   This file GENERATES all CSS Custom Properties from the SCSS token maps.
   It also contains and generates all theme variations.
   ============================================================================ */

// Helper function to safely get a map value
@function token($map, $key) {
  @if not map-has-key($map, $key) {
    @error "The key '#{$key}' is not defined in the map.";
  }
  @return map-get($map, $key);
}

// ============================================================================
// 1. DEFAULT (LIGHT THEME) ROOT DEFINITION
// ============================================================================
:root {
  // --- A. Generate Primitive Variables ---
  @each $name, $value in $colors { --sf-color-#{$name}: #{$value}; }
  @each $name, $value in $typography { --sf-type-#{$name}: #{$value}; }
  @each $name, $value in $spacing { --sf-space-#{$name}: #{$value}; }
  @each $name, $value in $radii { --sf-radius-#{$name}: #{$value}; }
  @each $name, $value in $sizes { --sf-size-#{$name}: #{$value}; }
  @each $name, $value in $effects { --sf-effect-#{$name}: #{$value}; }
  @each $name, $value in $layers { --sf-layer-#{$name}: #{$value}; }

  // --- B. Generate Semantic (Derived) Variables ---
  
  // Body & Page
  --body-bg: var(--sf-color-gray-200);
  --body-fg: var(--sf-color-gray-800);
  --heading-fg: var(--sf-color-gray-900);
  --link-fg: var(--sf-color-brand-primary);
  --link-hover-fg: var(--sf-color-brand-primary-hover);
  --border-color: var(--sf-color-gray-400);
  --border-color-subtle: var(--sf-color-gray-300);

  // Buttons
  --btn-primary-bg: var(--sf-color-brand-primary);
  --btn-primary-fg: var(--sf-color-white);
  --btn-primary-hover-bg: var(--sf-color-brand-primary-hover);
  
  // Cards
  --card-bg: var(--sf-color-gray-100);
  --card-border-color: var(--border-color-subtle);
  --card-shadow: var(--sf-effect-shadow-sm);
  --card-radius: var(--sf-radius-lg);

  // Navbar
  --nav-height: var(--sf-size-nav-height);
  --nav-bg: color-mix(in srgb, var(--sf-color-gray-100) 80%, transparent);
  --nav-border-color: var(--border-color-subtle);

  // ... Add any other derived variables here ...
}

// ============================================================================
// 2. THEME OVERRIDE DEFINITIONS
// ============================================================================

// --- Dark Theme ---
:root[data-theme="dark"] {
  // Re-define only the tokens that need to change
  --sf-color-brand-primary: #3b82f6;
  --sf-color-brand-primary-hover: #60a5fa;
  --sf-color-brand-primary-active: #2563eb;
  
  --sf-color-gray-900: #f8fafc; // Ink becomes light
  --sf-color-gray-800: #e2e8f0; // Body text
  --sf-color-gray-700: #cbd5e1;
  --sf-color-gray-600: #94a3b8;
  --sf-color-gray-500: #64748b; // Muted
  --sf-color-gray-400: #475569; // Line-1
  --sf-color-gray-300: #334155; // Line-2
  --sf-color-gray-200: #1e293b; // BG-1
  --sf-color-gray-100: #0f172a; // BG-2
  
  --sf-effect-shadow-sm: 0 1px 2px rgba(0,0,0,.5);
  --sf-effect-shadow-md: 0 6px 24px rgba(0,0,0,.45);
  --sf-effect-shadow-lg: 0 16px 32px rgba(0,0,0,.5);
  --sf-effect-backdrop-filter: rgba(0,0,0,.6);
}

// --- Sunset Theme ---
:root[data-theme="sunset"] {
  --sf-color-brand-primary: #f97316;
  --sf-color-brand-primary-hover: #fb923c;
  --sf-color-brand-primary-active: #ea580c;
  
  --sf-color-gray-900: #fff7ed;
  --sf-color-gray-800: #fde8f0;
  --sf-color-gray-700: #fbcfe8;
  --sf-color-gray-500: #e7c5e0;
  --sf-color-gray-400: #594c8d;
  --sf-color-gray-300: #4a3e79;
  --sf-color-gray-200: #3c316a;
  --sf-color-gray-100: #2a214d;
  
  --sf-effect-shadow-sm: 0 1px 2px rgba(25,10,50,.5);
  --sf-effect-shadow-md: 0 6px 24px rgba(25,10,50,.45);
  --sf-effect-shadow-lg: 0 16px 32px rgba(25,10,50,.5);
}

// --- Nature Theme ---
:root[data-theme="nature"] {
  --sf-color-brand-primary: #16a34a;
  --sf-color-brand-primary-hover: #15803d;
  --sf-color-brand-primary-active: #14532d;
  
  --sf-color-gray-900: #292524;
  --sf-color-gray-800: #44403c;
  --sf-color-gray-700: #57534e;
  --sf-color-gray-500: #a8a29e;
  --sf-color-gray-400: #d6d3d1;
  --sf-color-gray-300: #e7e5e4;
  --sf-color-gray-200: #f5f5f4;
  --sf-color-gray-100: #ffffff;
  
  --sf-effect-shadow-sm: 0 1px 2px rgba(120,113,108,.1);
  --sf-effect-shadow-md: 0 4px 12px rgba(120,113,108,.12);
  --sf-effect-shadow-lg: 0 12px 28px rgba(120,113,108,.15);
}

// --- Black & White Theme ---
:root[data-theme="b&w"] {
  --sf-color-brand-primary: #0a0a0a;
  --sf-color-brand-primary-hover: #404040;
  --sf-color-brand-primary-active: #000000;
  
  --sf-color-gray-900: #0a0a0a;
  --sf-color-gray-800: #171717;
  --sf-color-gray-700: #262626;
  --sf-color-gray-500: #737373;
  --sf-color-gray-400: #d4d4d4;
  --sf-color-gray-300: #e5e5e5;
  --sf-color-gray-200: #f5f5f5;
  --sf-color-gray-100: #ffffff;
  
  --sf-effect-shadow-sm: 0 1px 2px rgba(0,0,0,.08);
  --sf-effect-shadow-md: 0 4px 12px rgba(0,0,0,.1);
  --sf-effect-shadow-lg: 0 12px 28px rgba(0,0,0,.12);
}