/* ============================================================================
COMPONENT: NAVBAR (matches your _includes/navbar.html)
Depends on: tokens, variables, mixins, themes
============================================================================ */

.sf-header {
  position: sticky; top: 0; z-index: var(--sf-z-sticky, 1000);
  background: var(--sf-nav-bg, color-mix(in srgb, var(--sf-bg-2) 82%, transparent));
  border-bottom: 1px solid var(--sf-nav-border, var(--sf-line-2));
  backdrop-filter: blur(10px) saturate(1.2);
}

.sf-container { @include container(lg); }

/* ---- Bar ---- */
.sf-header__bar {
  display: grid;
  grid-template-columns: auto 1fr auto;
  align-items: center;
  gap: var(--sf-4);
  min-height: var(--sf-nav-height, 3.5rem);
  padding: 0 var(--sf-4);
}

/* ---- Brand ---- */
.sf-brand {
  display: inline-flex; align-items: center; gap: var(--sf-3);
  text-decoration: none; color: var(--sf-ink);
  @include interactive(filter);
  &:focus-visible { @include focus-ring; }
}
.sf-brand__image-logo { width: 2rem; height: 2rem; border-radius: var(--sf-radius-sm); display: block; }
.sf-brand__text { line-height: 1; }
.sf-brand-title { font-weight: 700; }

/* ---- Desktop nav ---- */
.sf-nav--desktop {
  display: none;
  @include breakpoint(md) { display: flex; align-items: center; gap: var(--sf-2); }
}
.sf-nav--desktop__link {
  display: inline-flex; align-items: center; gap: .5rem;
  min-height: calc(var(--sf-control-md) - 2px);
  padding: 0 var(--sf-3);
  border-radius: var(--sf-radius-md);
  color: var(--sf-fg-2);
  text-decoration: none;
  @include interactive(background-color);
  &:hover { background: var(--sf-bg-1); color: var(--sf-fg); }
  &.is-active { color: var(--sf-ink); background: color-mix(in srgb, var(--sf-brand) 12%, transparent); }
}

/* ---- Header actions (search/github/theme/toggle) ---- */
.sf-header__actions { display: inline-flex; align-items: center; gap: var(--sf-2); }
.sf-header__action-btn {
  @include button-reset;
  display: inline-flex; align-items: center; justify-content: center;
  width: 2.25rem; height: 2.25rem; border-radius: var(--sf-radius-md);
  color: var(--sf-fg);
  @include interactive(background-color);
  &:hover { background: var(--sf-bg-1); }
  &:focus-visible { @include focus-ring; }
  i { font-size: 1.125rem; line-height: 1; }
}

/* ---- Theme switcher: show one icon per theme (phosphor) ---- */
/* By default hide all theme icons inside the button */
.sf-theme-switcher i { display: none; }
/* LIGHT / OCEAN */
:root[data-theme="light"] .sf-theme-switcher .ph-sun,
:root[data-theme="ocean"] .sf-theme-switcher .ph-waves { display: inline-block; }
/* DARK */
:root[data-theme="dark"] .sf-theme-switcher .ph-moon { display: inline-block; }
/* SUNSET */
:root[data-theme="sunset"] .sf-theme-switcher .ph-sunset { display: inline-block; }
/* FOREST */
:root[data-theme="forest"] .sf-theme-switcher .ph-tree { display: inline-block; }
/* GRAPHITE */
:root[data-theme="graphite"] .sf-theme-switcher .ph-palette { display: inline-block; }
/* HIGH CONTRAST */
:root[data-theme="contrast"] .sf-theme-switcher .ph-contrast { display: inline-block; }

/* Tip: In your HTML, put all these icons in the switcher:
   <i class="ph-bold ph-sun"></i>
   <i class="ph-bold ph-moon"></i>
   <i class="ph-bold ph-waves"></i>
   <i class="ph-bold ph-sunset"></i>
   <i class="ph-bold ph-tree"></i>
   <i class="ph-bold ph-palette"></i>
   <i class="ph-bold ph-contrast"></i>
*/

/* ---- Mobile burger ---- */
.sf-nav-toggle {
  @include button-reset;
  display: inline-flex; align-items: center; justify-content: center;
  width: 2.25rem; height: 2.25rem; border-radius: var(--sf-radius-md);
  position: relative;
  @include interactive(background-color);
  span {
    position: absolute; left: 22%; right: 22%; height: 2px; background: var(--sf-fg);
    transition: transform .18s var(--sf-ease-standard, cubic-bezier(.2,0,0,1)), opacity .18s;
  }
  span:nth-child(1){ top: 35%; }
  span:nth-child(2){ top: 50%; transform: translateY(-50%); }
  span:nth-child(3){ top: 65%; }
  &:focus-visible { @include focus-ring; }
  @include breakpoint(md){ display: none; }
}
.sf-nav-toggle.is-active {
  span:nth-child(1){ transform: translateY(6px) rotate(45deg); }
  span:nth-child(2){ opacity: 0; }
  span:nth-child(3){ transform: translateY(-6px) rotate(-45deg); }
}

/* ---- Mobile nav panel (modal) ---- */
.sf-nav-panel {
  position: fixed; inset: 0; z-index: var(--sf-z-modal, 1100);
  display: grid; grid-template-columns: 1fr; align-items: stretch;
  pointer-events: none;
  opacity: 0; transition: opacity .18s ease;
}
.sf-nav-panel.is-open { pointer-events: auto; opacity: 1; }

.sf-nav-panel__backdrop {
  grid-row: 1; grid-column: 1; background: var(--sf-backdrop, rgba(3,12,33,.55));
}

.sf-nav-panel__content {
  grid-row: 1; grid-column: 1; align-self: start; margin: var(--sf-6) auto;
  width: min(640px, calc(100% - 2*var(--sf-4)));
  background: var(--sf-bg-2); color: var(--sf-fg); border: 1px solid var(--sf-line-2);
  border-radius: var(--sf-radius-lg); box-shadow: var(--sf-shadow-lg);
  transform-origin: var(--click-origin, 50% 0%);
  transform: scale(.98); opacity: 0;
  transition: transform .22s var(--sf-ease-decel, cubic-bezier(0,0,.2,1)), opacity .22s ease;
}
.sf-nav-panel.is-open .sf-nav-panel__content { transform: scale(1); opacity: 1; }

.sf-nav-panel__header {
  display:flex; align-items:center; justify-content:space-between;
  padding: var(--sf-3) var(--sf-4); border-bottom: 1px solid var(--sf-line-2);
  font-weight: 600; color: var(--sf-ink);
}
.sf-nav-panel__list { list-style: none; margin: 0; padding: var(--sf-2) 0; }
.sf-nav-panel__link {
  display:flex; align-items:center; gap: .75rem; padding: .75rem var(--sf-4);
  color: var(--sf-fg-2); text-decoration: none; border-radius: var(--sf-radius-md);
  &:hover { background: var(--sf-bg-1); color: var(--sf-fg); }
  &.is-active { background: color-mix(in srgb, var(--sf-brand) 10%, transparent); color: var(--sf-ink); }
}

/* ---- Search panel ---- */
.sf-search-panel {
  position: fixed; inset: 0; z-index: var(--sf-z-modal, 1100);
  display: grid; grid-template-columns: 1fr; align-items: start;
  padding-top: var(--sf-10);
  pointer-events: none; opacity: 0; transition: opacity .18s ease;
}
.sf-search-panel.is-open { pointer-events: auto; opacity: 1; }
.sf-search-panel .sf-container { width: min(960px, calc(100% - 2*var(--sf-4))); }

.sf-search-panel__form {
  display:flex; align-items:center; gap: var(--sf-3);
  background: var(--sf-bg-2); border: 1px solid var(--sf-line-2);
  border-radius: var(--sf-radius-lg); padding: var(--sf-3) var(--sf-4);
  box-shadow: var(--sf-shadow-md);
  input.sf-search-panel__input {
    @include input-reset; flex: 1 1 auto; color: var(--sf-fg);
    &::placeholder { color: var(--sf-muted); }
  }
}

/* ---- Search results wrapper ---- */
.sf-search-results-wrapper {
  position: fixed; inset-inline: 0; top: calc(var(--sf-10) + 4.5rem);
  display: none; z-index: var(--sf-z-popover, 1200);
}
.sf-search-results-wrapper.is-active { display: block; }
.sf-search-results {
  width: min(960px, calc(100% - 2*var(--sf-4)));
  margin-inline: auto; list-style: none; padding: 0; margin-top: var(--sf-3);
  background: var(--sf-bg-2); border: 1px solid var(--sf-line-2);
  border-radius: var(--sf-radius-lg); box-shadow: var(--sf-shadow-lg);
  overflow: hidden;
}
.sf-search-result + .sf-search-result { border-top: 1px solid var(--sf-line-2); }
.sf-search-result__link { display:block; padding: var(--sf-4); text-decoration:none; color: var(--sf-fg); }
.sf-search-result__title { margin: 0 0 .25rem; font-weight: 600; }
.sf-search-result__excerpt { margin: 0; color: var(--sf-fg-2); }
.sf-search-panel__no-results { padding: var(--sf-4); color: var(--sf-muted); }

/* ---- Desktop tweaks ---- */
@include breakpoint(md) {
  .sf-search-panel { padding-top: var(--sf-12); }
  .sf-search-results-wrapper { top: calc(var(--sf-12) + 5rem); }
}
